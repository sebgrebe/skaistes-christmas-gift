YUI.add("hermes-lang-common",function(e,o){e.Intl.add("hermes/common","en-US",{SIGN_UP:["Sign Up"],YOU:["You"],PHOTOSTREAM:["Photostream"],SETS:["Sets"],ALBUMS:["Albums"],MAP:["Map"],FAVORITES:["Favorites"],GALLERIES:["Galleries"],COLLECTIONS:["Collections"],ARCHIVES:["Archives"],TAGS:["Tags"],PHOTOS_OF:["Photos of"],PROFILE:["Profile"],POPULAR:["Popular"],EXPLORE:["Explore"],ACTIVITY:["Recent activity"],STATS:["Stats"],ORGANIZE:["Organize"],HELP:["Help"],SETTINGS:["Settings"],SIGN_OUT:["Sign Out"],FLICKRMAIL:["FlickrMail"],ERROR:["Error"],OK:["OK"],OOPS:["Oops!"],SIGN_IN:["Sign in"],FORGET_IT:["Forget it"],WARNING:["Warning"],DONE:["Done"],ZOINKS:["Zoinks!"],CANCEL:["Cancel"],ON:["On"],OFF:["Off"],ABOUT:["About"],JOBS:["Jobs"],BLOG:["Blog"],APPS:["Apps"],BRAND:["Brand"],DEVELOPERS:["Developers"],STATUS:["Status"],COMMUNITY_GUIDELINES:["Community guidelines"],REPORT_ABUSE:["Report abuse"],PRIVACY:["Privacy"],TERMS:["Terms"],YAHOO_SAFELY:["Yahoo Safely"],FEEDBACK:["Feedback"],MOBILE:["Mobile"],APP_GARDEN:["App Garden"],COMMUNITY:["Community"],API_DOC:["API Doc"],DEVELOPER_GUIDE:["Developer Guide"],DEVELOPER_BLOG:["Developer Blog"],HELP_FORUM:["Help forum"],GUIDELINES:["Guidelines"],NUMBER:[{type:"number",valueName:"num"}],RETRY:["Retry"],EDIT:["Edit"],MORE:["More"],DELETE:["Delete"],LOADING:["Loading"],FOLLOW:["Follow"],FOLLOWING:["Following"],UNFOLLOW:["Unfollow"],FRIEND:["Friend"],FRIENDS:["Friends"],FAMILY:["Family"],PUBLIC:["Public"],FRIENDS_AND_FAMILY:["Friends & Family"],FRIEND_AND_FAMILY:["Friend & Family"],ALL:["All"],A_YAHOO_COMPANY:["Flickr, a Yahoo company"],A_YAHOO_COMPANY_WITH_LINK:['Flickr, <a href="https://info.yahoo.com">a Yahoo company</a>'],A_YAHOO_COMPANY_WITH_TRACKED_LINK:['Flickr, <a href="https://info.yahoo.com" data-track="footer-yahoo">a Yahoo company</a>'],CONFIRMATION:["Confirmation"],FAVORITE:["Favorite"],SEARCH:["Search"],CONFIRM:["Confirm"],SELECT:["Select"],NEW:["New"],LOADING_WITH_ELLIPSES:["Loading..."],NONE:["None"],TITLE:["Title"],DESCRIPTION:["Description"],DECLINE:["Decline"],ACCEPT:["Accept"],CIRCA:["Circa"],SOMETIME_IN:["Sometime in..."],JANUARY:["January"],FEBRUARY:["February"],MARCH:["March"],APRIL:["April"],MAY:["May"],JUNE:["June"],JULY:["July"],AUGUST:["August"],SEPTEMBER:["September"],OCTOBER:["October"],NOVEMBER:["November"],DECEMBER:["December"],SAVE:["Save"],PLEASE_TRY_AGAIN:["Please try again"],YES:["Yes"],SQUARE:["Square"],THUMBNAIL:["Thumbnail"],SMALL:["Small"],MEDIUM:["Medium"],LARGE:["Large"],XLARGE:["X-Large"],ORIGINAL:["Original"],REPLACE:["Replace"],SAVING:["Saving"],REPLACING:["Replacing"],JOIN:["Join"],SELECTED:[{type:"plural",valueName:"count",options:{one:"${#} selected",other:"${#} selected"}}],PREVIEW:["Preview"],DATE_TAKEN:["Date Taken"],DATE_POSTED:["Date Posted"],DATE_UPLOADED:["Date Uploaded"],PEOPLE:["People"],BETA:["Beta"],INVALID_DATE:["Invalid Date."],INVALID_DATE_TAKEN:["Invalid Date Taken."],INVALID_DATE_POSTED:["Invalid Date Posted."],INVALID_DATE_UPLOADED:["Invalid Date Uploaded."],FUTURE_DATE_POSTED:["Date Posted is set to the future."],FUTURE_DATE_UPLOADED:["Date Uploaded is set to the future."],INVALID_DATE_VALUE:["One or more of the dates you entered was invalid."],INVALID_DATE_TAKEN_VALUE:["Date Taken value is invalid."],INVALID_DATE_POSTED_VALUE:["Date Posted value is invalid."],INVALID_DATE_UPLOADED_VALUE:["Date Uploaded value is invalid."],JOIN_FLICKR:["Join Flickr"],GET_PRO:["Get Pro"],DATE_UPLOADED_BEFORE_ACCOUNT:["Date Uploaded must be after your account creation date of ",{type:"date",valueName:"intlDate",format:"long"},"."],DOWNLOAD:["Download"],CHOOSE_VALID_DATE:["Please choose a valid date."],CHANGE:["Change"],FUTURE_DATE_TAKEN:["Date Taken is set to the future."],BY_USER:["by ","${user}"],BY_YOU:["by YOU!"],PHOTO_SELECTOR_ERROR_MESSAGE_GENERIC:["There was a problem uploading your photo. Please try again."],PHOTO_SELECTOR_ERROR_MESSAGE_FILE_TYPE:["Looks like this photo has an invalid file type. Upload a photo that is either a PNG or JPG."],PHOTO_SELECTOR_ERROR_MESSAGE_FILE_SIZE:["Looks like this photo is too large to upload. The largest photo size we can upload is 250 MB."],PHOTO_SELECTOR_ERROR_MESSAGE_FILE_COUNT:["Select only one photo to upload."],PHOTO_SELECTOR_ERROR_MESSAGE_LOW_QUALITY:['Looks like this photo doesn\'t meet the minimum requirements to get printed. Please choose a photo that\'s at least 975 &times; 825 pixels. Learn more about <a href="http://help.yahoo.com/kb/index?page=content&y=PROD_FLICKR&locale=en_US&id=SLN22567" target="_blank">requirements</a> for print products.'],PHOTO_SELECTOR_ERROR_MESSAGE_COLOR_SPACE:['Sorry, we cannot print photos with a CMYK or ProPhoto RGB colorspace. We recommend photos with an sRGB color space. <a href="https://help.yahoo.com/kb/flickr/creations-faq-sln22216.html?impressions=true#cont33" target="_blank">Learn more</a>.'],PHOTO_SELECTOR_BACK_TO_ALBUM_LIST:["Back to album list"],PHOTO_SELECTOR_BACK_TO_CATEGORY_LIST:["Back to category list"],PHOTO_SELECTOR_BACK_TO_SEARCH_LIST:["Back to search list"],PHOTO_SELECTOR_EMPTY_PUBLIC_PHOTOS:["No public photos."],PHOTO_SELECTOR_EMPTY_PHOTOS:["No photos."],PHOTO_SELECTOR_NO_ALBUMS:["No albums."],MARKETPLACE:["Marketplace"],USERS_FAVES:["${who}","’s favorites"],USERS_ALBUMS:["${who}","’s albums"],USERS_GALLERIES:["${who}","’s galleries"],USERS_GROUPS:["${who}","’s groups"],LOAD_MORE_RESULTS:["Load more results"],CREATE_AN_ACCOUNT:["Create an account"],SIGN_IN_MESSAGE:["Sign in to Flickr using your Yahoo account to get started."],MISMATCHED_NSID_ERROR:['Something went wrong. Click "OK" to reload the page, or "Cancel" if you want to continue to browse the page (you won\'t be able to perform any actions, however).'],NETWORK_CONNECTIVITY_ISSUE:['Something went wrong reading data from our server.  Please verify your network settings and browser plugin/extension configurations.<br><br>Click "OK" to reload the page, or "Cancel" if you want to continue to browse the page (you may not be able to perform any actions, however).'],IE_STORAGE_ISSUE:['Something went wrong displaying images in your browser.  Please verify your browser settings at <b>Tools > Internet Options > General tab, Browsing history, \'Settings\' button > caches and databases</b>.<br><br>Click "OK" to reload the page, or "Cancel" if you want to continue to browse the page (you may not be able to perform any actions, however).'],PHOTO_REMOVE_ERROR:["Something went wrong removing the photo...please try again."],LEARN_MORE:["Learn more"],LEARN_MORE_ABOUT_PRO:["Learn more about Pro"],EVERYTHING:["Everything"],ALPHA:["Alpha"],BACK:["Back"],UNTITLED:["Untitled"],HIDE_PHOTOS_FROM_PERSON:["Temporarily hide all photos from this person"],SHOW_MORE:["Show more"],CHOOSE_FILE:["Choose file"],PHOTO_BOOKS:["Photo books"],WALL_ART:["Wall art"],UPLOADING:["Uploading"],NUMERIC_PROGRESS_COUNT:["${progress}"," of ","${total}"],UPLOAD_DROP_TARGET:["Let go! We'll take it from here."],DRAG_AND_DROP:["You can drag and drop photos anywhere on this page"],OR:["or"],SELECT_FILES_TO_UPLOAD:["Select files to upload"],INSTALL:["Install"],INSTALL_FLICKR_UPLOADER_FOR_MAC:["Install Flickr Uploadr for Mac to quickly and safely backup your entire photo collection."],INSTALL_FLICKR_UPLOADER_FOR_WINDOWS:["Install Flickr Uploadr for Windows to quickly and safely backup your entire photo collection."],FLICKR_IS_ALMOST_CERTAINLY:["Flickr is almost certainly the best online photo management and sharing application in the world. Show off your favorite photos and videos to the world, securely and privately show content to your friends and family, or blog the photos and videos you take with a cameraphone."],TOGGLE_SLIDESHOW:["Toggle slideshow"],UPLOAD_MORE_INFO:['For details about our supported file formats, <a href="https://help.yahoo.com/kb/flickr/upload-limitations-flickr-sln15628.html" target="_blank">click here</a>.'],UPLOAD_MORE_INFO_WITH_LINK:['For details about our supported file formats, <a href="',"${supportURL}",'" target="_blank">click here</a>.'],UPLOAD_ERROR_TITLE:["Uh oh..."],UPLOAD_ERROR_CATEGORY_INVALID:['Either we don\'t support these file types, or the files are damaged. <a href="https://help.yahoo.com/kb/flickr/upload-limitations-flickr-sln15628.html" target="_blank">Click here</a> for more info.'],UPLOAD_ERROR_CATEGORY_INVALID_WITH_LINK:["Either we don't support these file types, or the files are damaged. <a href=\"","${supportURL}",'" target="_blank">Click here</a> for more info.'],UPLOAD_ERROR_CATEGORY_GENERIC:['These files failed to upload. You might try uploading them again. <a href="https://help.yahoo.com/kb/flickr/upload-limitations-flickr-sln15628.html" target="_blank">Click here</a> for more info.'],UPLOAD_ERROR_CATEGORY_GENERIC_WITH_LINK:['These files failed to upload. You might try uploading them again. <a href="',"${supportURL}",'" target="_blank">Click here</a> for more info.'],TRY_MDOT:["Try Flickr optimized for your mobile device"],VIDEO_NOT_SUPPORTED:["I'm sorry. Your browser doesn't support HTML5 video."],UNBLOCK:["Unblock"],START_SLIDESHOW:["Start slideshow"],EACH_FLICKR_ACCOUNT_HAS_STORAGE:["Each Flickr account comes with 1,000GB of free photo storage."],BUY_LICENSE:["License"],BUY_PHOTO:["Buy photo"],BUY:["Buy"],LICENSE_PHOTO:["License photo"],HAVE_YAHOO_ACCOUNT:["Have a Yahoo account?"],SIGN_UP_WITH_YAHOO:["Sign up with Yahoo"],SIGN_INTO_FLICKR:["Sign into Flickr"],NEVER_DELETE_WITH_ONE_TB:["Never delete a photo again with one terabyte of free storage."],CLICK_BUTTON_THIRD_PARTY:["Clicking this button will take you to a third party website."],LICENSE_TITLE_0:["All rights reserved"],LICENSE_DESC_0:["You must request permission from the creator to use this work."],LICENSE_TITLE_1:["Attribution, non-commercial, share alike"],LICENSE_DESC_1:["You can use this work, but only in a non-commercial way, so long as credit is given to the creator. You must then allow your work to be used under the same terms."],LICENSE_TITLE_2:["Attribution, non-commercial"],LICENSE_DESC_2:["You can use this work, but only in a non-commercial way, so long as credit is given to the creator."],LICENSE_TITLE_3:["Attribution, non-commercial, no derivatives"],LICENSE_DESC_3:["You can use this work, in its original form without any modifications and only in a non-commercial way, so long as credit is given to the creator."],LICENSE_TITLE_4:["Attribution only"],LICENSE_DESC_4:["You can use this work so long as credit is given to the creator."],LICENSE_TITLE_5:["Attribution, share alike"],LICENSE_DESC_5:["You can use this work so long as credit is given to the creator. You must then allow your work to be used under the same terms."],LICENSE_TITLE_6:["Attribution, no derivatives"],LICENSE_DESC_6:["You can use this work, in its original form without any modifications, so long as credit is given to the creator."],LICENSE_TITLE_7:["No known restrictions"],LICENSE_DESC_7:["The individual or organization posting the work is unaware of any restrictions. You should review the work prior to proceeding with use."],LICENSE_TITLE_8:["U.S. government works"],LICENSE_DESC_8:["Copyright protection is not available for any work of the United States Government."],LICENSE_TITLE_9:["Dedicated public domain work"],LICENSE_DESC_9:["You can use this work since the copyright is no longer enforced."],LICENSE_TITLE_10:["Public domain work"],LICENSE_DESC_10:["You can use this work since the copyright has expired."],TRENDING:["Trending"],GROUP_YOUR_BEST_SHOT:["Your Best Shot 2015"],GROUP_YOUR_BEST_SHOT_2016:["Your Best Shot 2016"],DELETED_USER:["deleted"],EXPLORE_SLOW:["We're having some trouble displaying Explore at the moment. Please try again."],MODULES_BLOCKED:['Something went wrong loading required modules to display this page.  Please disable any browser extensions that may be blocking the page resources.<br><br>After disabling extensions, click "OK" to reload the page, or "Cancel" if you want to continue to browse the page (you may not be able to perform any actions, however).'],HOME:["Home"],MAIN:["Main"],SECONDARY:["Secondary"],FILTER:["Filter"],CLOSE:["Close"],USER_ICON:["user icon"],GROUP_ICON:["group icon"],AD_ICON:["ad icon"],ADD_TO_FAVORITES:["Add to Favorites"],LEFT_ARROW:["Left arrow"],RIGHT_ARROW:["Right arrow"],DONT_SHOW_IN_FEED:["Don't show in my feed"],SHOW_IN_FEED:["Show in my feed"],SEARCH_FOR_SIMILAR_PHOTOS:["Search for similar photos"],SEARCH_FOR_SIMILAR_PHOTOS_WITH_TERM:["Search for similar photos with original search term"],FAVES_SHORT:["Faves"],GROUP_BAN_USER:["Ban user from the group"],GROUP_BAN_USER_REMOVE_PHOTOS:["Ban user and remove their photos from the group"],GROUP_REMOVE_USER:["Remove user from the group"],GROUP_REMOVE_USER_REMOVE_PHOTOS:["Remove user and their photos from the group"],REFRESH:["Refresh"],ALMOST_DONE:["Almost done..."],GROUPS:["Groups"],"404_PHOTOSTREAM_DELETED":["It appears the photostream you seek no longer exists."],"404_PHOTOSTREAM_NONEXISTENT":["It appears the photostream you seek doesn’t exist."],"404_PROFILE_DELETED":["It appears the profile you seek no longer exists."],"404_PROFILE_NONEXISTENT":["It appears the profile you seek doesn’t exist."],"404_PHOTO_VIDEO_NONEXISTENT":["It appears the photo or video you seek no longer exists."],"404_PHOTO_VIDEO_PRIVATE":["It appears you don’t have permission to view this photo or video."],"404_ALBUM_NONEXISTENT":["It appears the album you seek doesn’t exist."],"404_ALBUM_PRIVATE":["It appears you don’t have permission to view this album."],"404_GROUP_NONEXISTENT":["It appears the group you seek doesn’t exist."],"404_GROUP_PRIVATE":["It appears you don’t have permission to view this group."],"404_GROUP_TOPIC_NONEXISTENT":["It appears the discussion topic you seek doesn’t exist."],"404_GROUP_REPLY_NONEXISTENT":["It appears the discussion reply you seek doesn’t exist."],"404_EXPLORE_NONEXISTENT":["It appears there are no photos for the requested date."],"404_PERSON_NONEXISTENT":["It appears the account you seek doesn’t exist."],"404_DOWNLOAD_NONEXISTENT":["It appears the download you seek doesn’t exist."],"404_GALLERY_NONEXISTENT":["It appears the gallery you seek doesn’t exist."],DISMISS:["Dismiss"],BLURB:["Blurb"],ALPHA_GROUP_SHARE_FEEDBACK:['This new Flickr feature is only visible to Alpha Group members. Please share your feedback <a href="',"${url}",'" target="_blank">here</a>.'],JUSTIFIED_VIEW:["Justified view"],THUMBNAIL_VIEW:["Thumbnail view"],TILE_VIEW:["Tile view"],LARGE_VIEW:["Large view"],ITEM_COUNT_FORMATTED:[{type:"plural",valueName:"itemCount",options:{one:["${countString}"," item"],other:["${countString}"," items"]}}],PHOTO_COUNT_FORMATTED:[{type:"plural",valueName:"photoCount",options:{one:["${countString}"," photo"],other:["${countString}"," photos"]}}],VIDEO_COUNT_FORMATTED:[{type:"plural",valueName:"videoCount",options:{one:["${countString}"," video"],other:["${countString}"," videos"]}}],VIEW_COUNT_FORMATTED:[{type:"plural",valueName:"viewCount",options:{one:["${countString}"," view"],other:["${countString}"," views"]}}],COMMENT_COUNT_FORMATTED:[{type:"plural",valueName:"commentCount",options:{one:["${countString}"," comment"],other:["${countString}"," comments"]}}],FAVE_COUNT_FORMATTED:[{type:"plural",valueName:"faveCount",options:{one:["${countString}"," fave"],other:["${countString}"," faves"]}}],ALBUM_LABEL:["Album"],GALLERY_LABEL:["Gallery"],BY_USER_WITH_URL:['by <a href="',"${userUrl}",'">',"${username}","</a>"],ADD:["ADD"],ITEMS:["Items"],FLICKR_LOVES_OLD_SCHOOL_PROS:["Flickr ♥ our Old School Pros"],MODIFIED_FROM_WITH_LICENSE:['Modified from <a href="',"${userUrl}",'">',"${user}",'</a>, <a href="',"${licenseUrl}",'">',"${licenseName}","</a>"],PHOTO_BY_WITH_LICENSE:['Photo by <a href="',"${userUrl}",'">',"${user}",'</a>, <a href="',"${licenseUrl}",'">',"${licenseName}","</a>"],PHOTOS_BY_MULTIPLE_WITH_LICENSE:['Photos by <a href="',"${user1Url}",'">',"${user1}",'</a>, <a href="',"${user2Url}",'">',"${user2}",'</a>, and <a href="',"${user3Url}",'">',"${user3}",'</a>, <a href="',"${licenseUrl}",'">',"${licenseName}","</a>"],LOG_OUT:["Log out"],REMIND_ME_LATER:["Remind me later"],GET_FLICKR_PRO:["Get Flickr Pro"],ERROR_UH_OH:["Uh oh!"],DR_SOMETHING_WENT_WRONG_ERROR_MESSAGE:['Please check your browser extensions and ad blockers and try again. If the problem persists, please reach out to us at <a href="https://help.flickr.com" target="_blank">https://help.flickr.com</a>.'],SUPPORT:["Support"],GOT_IT:["Got it"],VIDEO_STREAMING_OFF:['Video streaming is currently unavailable. More info: <a href="',"${url}",'">link</a>'],VIDEO_STILL_PROCESSING:['This video is being processed. Processing may take a while. More info: <a href="',"${url}",'">link</a>'],HAVE_A_FLICKR_ACCOUNT:["Have a Flickr account?"],HI_MESSAGE_GREETING:["Hi ","${username}",","],MYSTERIOUS_PLACE:["A mysterious place with no name"],NEW_TITLE:["New!"],GO_BACK_BUTTON:["Go back"],EVENTS:["Events"],SMUG_FLICKR_FOOTER_ATTRIBUTION:['<a class="smug-link" href="',"${smugUrl}",'">SmugMug</a>+<a class="flickr-link" href="',"${flickrUrl}",'">Flickr</a>.'],CONNECTING_PEOPLE_THROUGH_PHOTOGRAPHY:["Connecting people through photography."],UPGRADE_PRO_HIDE_ADS:["Upgrade to Flickr Pro to hide these ads"]})},"@VERSION@",{requires:["intl"]});YUI.add("banner-helper",function(e,n){require("hermes-core/flog")(n),e.mix({langBundles:["featured-banner"]},e.Localizable);e.BannerHelper=function(n){function r(){o=t.sort(function(e,n){return e.priority-n.priority})}var i=this,t=[],o=[],a={loginMigration:function(r){return{priority:"priority"in r?r.priority:Number.MAX_VALUE,placement:"placement"in r?r.placement:"header",load:function(){return e.Promise.resolve()},canShowBanner:function(){var e=!1,r=n.getViewer().isCognitoUser;return!n.getViewer().signedIn||r||(function(){var e=n.flapp.get("activeView").name;return!!(e&&["products-pro-2018-view"].indexOf(e)>-1)})()||(e=!0),e},viewName:"login-migration-banner-view",viewConfig:{}}},pastDue:function(r){var i;return{priority:"priority"in r?r.priority:Number.MAX_VALUE,placement:"placement"in r?r.placement:"header",load:function(){return n.getViewer().signedIn?n.getModel("subscription-history-list-models",n.getViewer().nsid).then(function(n){var r=new e.SubscriptionsHelper;i=r.isUserPastDue(n)}.bind(this)):(i=!1,e.Promise.resolve())},canShowBanner:function(){var r=!1;return n.getViewer().signedIn&&i&&!n.getCookie(e.config.flickr.banners.dismiss_past_due_banner_name)&&!(function(){var e=n.flapp.get("activeView").name;return!!(e&&["products-pro-2018-view","account-settings-view"].indexOf(e)>-1)})()&&(r=!0),r},viewName:"past-due-banner-view",viewConfig:{}}},cookie:function(r){return{priority:"priority"in r?r.priority:Number.MAX_VALUE,placement:"placement"in r?r.placement:"header",load:function(){return e.Promise.resolve()},canShowBanner:function(){return!n.getCookie(e.config.flickr.banners.dismiss_cookie_banner_name)&&e.config.flickr.geo.eu},viewName:"cookie-banner-view",viewConfig:{}}}};return this.loadBanners=function(n){var i=n.map(function(n){return(function(n){var i=new a[n.type]({priority:n.priority,placement:n.placement});return i?i.load().then(function(){!(function(e){t.push(e),r()})(i)}):e.Promise.resolve()})(n)});return e.Promise.all(i)},this.getBanners=function(e){var n=[];return e.forEach(function(e){var i=(function(e){var i,t=o.find(function(n,r){if((void 0===e||n.placement===e)&&n.canShowBanner())return i=r,!0});if(t)return(function(e){n.splice(e,1),r()})(i),t})(e);i&&n.push(i)}),n},this.getQueue=function(){return o},this.typeObjects=a,this.renderBannerView=function(e){return(function(e){return n.getView(e.viewName,{appContext:n}).then(function(e){var r;return n.getView("banner-view",{appContext:n,subview:e}).then(function(e){return(r=e).initialize()}).then(function(){return r})})})(e).then(function(n){i.fire("renderBanner",{placement:e.placement,bannerView:n})})},this},e.augment(e.BannerHelper,e.EventTarget)},"@VERSION@",{requires:["banner-view","event-custom"]});YUI.add("app-context",function(e,i){var t,n=require("hermes-core/flog")(i),o=require("hermes-core/fletrics"),r=YUI.Env.isServer?e.config.flickr.api.server_default_timeout:e.config.flickr.api.client_default_timeout,s=YUI.Env.isServer?e.config.flickr.api.server_retry_timeout:e.config.flickr.api.client_retry_timeout,a=[117,118,119],l=new RegExp(e.config.flickr.api.write_api_method_regex),c=e.config.flickr.model_eviction,h={};(t=e.AppContext=function(i){(i=i||{}).request&&(this.request=i.request),this.params={},this._initializeParams(i),this.viewTiming={},this.modelRegistries={},this.modelImportExport=new e.ModelImportExport(this),this.flickrAPI=new e.FlickrAPI(this.request,this),this.auth=i.auth,this.flapp=i.flapp,this.writeAPICallsMadeOnThisPage={},this._moduleInstances={},this._pendingYUIPromises={},this._loadedViews={},this._apiCalls={},this._previousLocation=null,this._uploadInProgress=!1,this._pendingUploadErrorModal=null,this._concurrentAPICalls=0,this._apiQueueOrder=[],this._apiQueueFunctions={},this._preliminaryNsid=null,this.flipper=new e.Flipper(i.flipper),this.experiments={fullscreen:new e.Experiments.Fullscreen(this),optOut:new e.Experiments.OptOut(this)},this.secure="https"===this.protocol,this.adManager=new e.AdManager(this.params.referrer,this),this.viewportData=new e.ViewportData(this),this.clientId="f"+Math.round(1e4*Math.random()).toString(36),this.isCSSLoaded=!1,this.bannerManager=new e.BannerHelper(this),this.initGlobalEvictionExemptionConfig()}).getValidParams=function(){return["bucket","protocol","buckets","slice","random_slice","referrer","flipper","lang","gp_code","gp_owner","share_code"]},t.prototype={routeConfig:{},_initializeParams:function(e){var i=this;t.getValidParams().forEach(function(t){e.request&&t in e.request&&(e[t]=e.request[t]),t in e&&(i[t]=e[t],i.params[t]=e[t])})},instantiateYUIModule:function(i,t){if(!e.Lang.isString(i)||!e.Lang.isFunction(t))return e.Promise.reject("[app-context] `instantiateYUIModule` called without a `name` or `initializer`.");var n,o=this._moduleInstances,r=this._pendingYUIPromises;return r[i]||(o[i]?r[i]=e.Promise.resolve(o[i]):(n=YUI.Env.isServer?this.request.app.yui:e,r[i]=e.betterUse(i,n).then(function(){var e=t();return o[i]=e,delete r[i],e}))),r[i]},getModelRegistry:function(i){if(!e.Lang.isString(i))return e.Promise.reject("[app-context] `getModelRegistry` called without a `name`.");var t,r=this;return this.instantiateYUIModule(i,function(s){if(!e.Models||!e.Models[i]||"function"!=typeof e.Models[i])throw n.error("There was an error loading the modelregistry",{status:s}),o.increment("appContext.getmodelregistry.failures"),t=new Error("[app-context] - Model registry failed to load:"+i),t.moduleLoadingError=!0,t;var a=new e.Models[i](r);return r.modelRegistries[i]=a,a})},getModel:function(i,t,n){return e.Lang.isString(i)&&t?this.getModelRegistry(i).then(function(i){return this._refetchExistingModels&&(e.Lang.isObject(t,!0)?i.attributeSearch(t):[t]).forEach(function(e){this.canEvictModel(i,e)&&this.evictModel(i,e)}.bind(this)),i.get(t,n)}.bind(this)):e.Promise.reject("[app-context] `getModelRegistry` called without a `registryName` or `modelId`.")},markAsNewlyFetched:function(e,i){this._refetchExistingModels&&(this._refetchedModels[e]||(this._refetchedModels[e]={}),this._refetchedModels[e][i]=!0)},getRoute:function(i){var t,r=this;return this.instantiateYUIModule(i,function(s){if(!e.Routes||!e.Routes[i]||"function"!=typeof e.Routes[i])throw n.error("There was an error loading the route",{status:s}),o.increment("appContext.getroute.failures"),t=new Error("[app-context] - Route failed to load:"+i),t.moduleLoadingError=!0,t;return new e.Routes[i](r)})},getView:function(i,t,r){var s,a=this,l=YUI.Env.isServer?a.request.app.yui:e,c=[i];return t=t||{},t.appContext=a,e.betterUse(c,l).then(function(r){if(!e.Views||!e.Views[i]||"function"!=typeof e.Views[i])throw n.error("There was an error loading the view",{status:r}),o.increment("appContext.getview.failures"),s=new Error("[app-context] - View failed to load:"+i),s.moduleLoadingError=!0,s;return a._loadedViews[i]=!0,new e.Views[i](t)})},getLoadedViews:function(){return Object.keys(this._loadedViews)},setGPCredentials:function(e){null===e?(delete this.params.gp_owner,delete this.params.gp_code,delete this.params.share_code,delete h.gp_owner,delete h.gp_code,delete h.share_code,n.info("Setting GP credentials to null")):null!==e&&e.gp_code&&(this.params.gp_owner=e.gp_owner,this.params.gp_code=e.gp_code,this.params.share_code=e.share_code,h.gp_owner=e.gp_owner,h.gp_code=e.gp_code,h.share_code=e.share_code,n.info("Setting GP credentials to "+e.share_code))},getCookie:function(i){return YUI.Env.isServer?this.request.cookies[escape(i)]:e.Cookie.get(i)},setCookie:function(i){if(YUI.Env.isServer)n.warn("You can't set a cookie from the server with AppContext -- use middleware.",i);else{i.cookieName&&void 0!==i.cookieValue&&i.path||n.error("Missing important parameters to set a cookie");var t=i.cookieName,o=i.cookieValue,r=i.domain||".flickr.com",s=i.path,a=i.expiresMonthsFromNow||3,l=i.expires?i.expires:e.moment().add(a,"months").toDate();i.remove&&e.Cookie.remove(t,{domain:i.domain||".flickr.com",path:s}),e.Cookie.set(t,o,{domain:r,path:s,expires:l})}},removeCookie:function(i){YUI.Env.isServer?n.warn("You can't remove a cookie from the server with AppContext -- use middleware.",i):(i.cookieName&&i.path||n.error("Missing important parameters to remove a cookie"),e.Cookie.remove(i.cookieName,{domain:i.domain||".flickr.com",path:i.path}))},getViewer:function(){var e={},i=this;return e.getPixelRatio=function(){var e;return(e=YUI.Env.isServer?i.getCookie("density"):window.devicePixelRatio)||(e=1),e},this.auth&&this.auth.signedIn?(e.nsid=this.auth.user.nsid,e.intl=this.auth.intl,e.signedIn=this.auth.signedIn,e.isInsecureGod=this.auth.isInsecureGod,e.isMinor=this.auth.isMinor,e.isPro=this.auth.user.ispro,e.canReact=this.auth.canReact,e.isCognitoUser=this.auth.isCognitoUser,e.prefs={timezonePref:this.auth.timezonePref,downloadAccessPref:this.auth.downloadAccessPref}):this._preliminaryNsid?(e.nsid=this._preliminaryNsid,e.signedIn=!0):(e.signedIn=!1,e.prefs={timezonePref:{name:"",dst:!1,offset:"+00:00",isDefaults:!0}}),e},setPreliminaryViewerNsid:function(e){this._preliminaryNsid=e},getKeyboardManager:function(){return this._keyboardManager||(this._keyboardManager=new e.KeyboardManager),this._keyboardManager},initGlobalEvictionExemptionConfig:function(){var e=this.getViewer().nsid;this._globalEvictionExemptionConfig={},e&&(this._globalEvictionExemptionConfig["person-preferences-models"]={exemptIds:[e]})},getPreviousURL:function(){var e="";return this._previousLocation&&(e=this._previousLocation.pathname,this._previousLocation.querystring&&(e+="?"+this._previousLocation.querystring),this._previousLocation.hash&&(e+="#"+this._previousLocation.hash)),e},getPreviousLocation:function(){return e.merge(this._previousLocation)},setPreviousLocation:function(){this._previousLocation=this.getLocation()},updateModelRefetchState:function(i,t){if(!this.flipper.isFlipped("evict-models-on-navigate")||!i||t)return this._refetchExistingModels=!1,void(this._refetchedModels=null);var n,o;this._previousLocation&&(n=e.URLHelper.getSiteSectionByURL(this._previousLocation.pathname)),i&&(i="/"+i.split("/").slice(3).join("/"),o=e.URLHelper.getSiteSectionByURL(i)),this._refetchExistingModels=void 0,o&&c.entry_refetch_exemptions[o.name]&&(this._refetchExistingModels=!1),n&&c.exit_refetch_exemptions[n.name]&&(this._refetchExistingModels=!1),void 0===this._refetchExistingModels&&o&&n&&(c.transition_refetch_exemptions[n.name]&&c.transition_refetch_exemptions[n.name][o.name]?this._refetchExistingModels=!1:this._refetchExistingModels=n.name!==o.name),void 0===this._refetchExistingModels&&(this._refetchExistingModels=!1),this._refetchedModels={}},hasClientSideRouted:function(){return!!this._clientSideRouted},setClientSideRouted:function(e){this._clientSideRouted=e},getReferrer:function(){var e;try{e=this.flapp.get("activeView").getViewDataFromHistory("referrer")}catch(e){}return e},getLocation:function(){var i;return YUI.Env.isServer?(i={protocol:this.request.protocol,hostname:this.request.hostname,pathname:this.request.path,query:this.request.query,querystring:this.request.query?e.QueryString.stringify(this.request.query):"",hash:""}).href=i.protocol+"://"+i.hostname+this.request.originalUrl:(i={protocol:e.config.win.location.protocol.split(":")[0],hostname:e.config.win.location.hostname,pathname:e.config.win.location.pathname,querystring:e.config.win.location.search.split("?")[1],href:e.config.win.location.href,hash:e.config.win.location.hash}).query=i.querystring?e.QueryString.parse(i.querystring):"",i},getViewCounter:function(){return this._viewCounter||(this._viewCounter=new e.ViewCounter({appContext:this})),this._viewCounter},getBucket:function(e){if(this.buckets)return this.buckets[e]},handleMismatchedNSID:function(){var i,t;i=e.mix({langBundles:["common"],appContext:this},e.Localizable),(t=new e.Views.FluidModal({title:i.intlMessage({intlName:"common.ERROR"}),actionButtonLabel:i.intlMessage({intlName:"common.OK"}),textMessage:i.intlMessage({intlName:"common.MISMATCHED_NSID_ERROR"}),appContext:this,dismissOnOverlayClick:!1,dismissOnActionClick:!0,actionButtonDisabled:!1,showCancelButton:!0,hideModalOverlay:!1,showCancelX:!0})).on("actionClick",function(i){e.config.win.location.reload(!0)}),t.show()},mitigateClientPanda:function(i){var t,n;return t=e.mix({langBundles:["common"],appContext:this},e.Localizable),(n=new e.Views.FluidModal({title:t.intlMessage({intlName:"common.ERROR"}),actionButtonLabel:t.intlMessage({intlName:"common.OK"}),htmlMessage:t.intlMessage({intlName:i}),appContext:this,dismissOnOverlayClick:!1,dismissOnActionClick:!0,actionButtonDisabled:!1,showCancelButton:!0,hideModalOverlay:!1,showCancelX:!0})).on("actionClick",function(i){e.config.win.location.reload(!0)}),n.show(),e.PromiseChainDestroyer()},callAPI:function(i,t,o,c){var u,d,p,f=this,g=[i,t,null,c];return o=o&&!YUI.Env.isServer,g=null!==h?[i,e.merge(t,h),null,c]:[i,t,null,c],u=i+"__"+Object.keys(t).sort().map(function(e){return encodeURIComponent(e)+"_"+encodeURIComponent(t[e])}).join("__"),this._apiCalls[u]?(e.config.flickr.cameraroll.suppress_logging&&"flickr.cameraroll.getPhotosByOffset"===i||n.log("Reusing API call",{method:i}),f._apiQueueOrder.length>1&&(p=f._apiQueueOrder.indexOf(u))>-1&&p<f._apiQueueOrder.length-1&&(f._apiQueueOrder.splice(p,1),f._apiQueueOrder.push(u)),this._apiCalls[u].then(function(i){return e.clone(i,!0)},function(i){throw e.clone(i,!0)})):(o&&(g.push(null),g.push({timeout:r})),i.match(l)&&this.cacheWriteAPICall(u,i),this._apiCalls[u]=new e.Promise(function(t,r){var l;l=function(){f.flickrAPI.callMethod.apply(f.flickrAPI,g).then(function(e){return f.onAPICallComplete(u,!0),e},function(t){if(f.onAPICallComplete(u,!1),f.flipper.isFlipped("enable-viewer-nsid-check")&&!YUI.Env.isServer&&-1!==a.indexOf(t.code))return f.handleMismatchedNSID(),e.PromiseChainDestroyer();if(!YUI.Env.isServer&&0===t.status&&0===t.total)return f.mitigateClientPanda("common.NETWORK_CONNECTIVITY_ISSUE");if(o&&(t.clientTimeout||0===t.status||t.transportFailure)){if(n.log("Retrying API call",{method:i}),delete f._apiCalls[u],!YUI.Env.isServer&&e.config.win.beaconError){if(e.config.win.document)try{t.domain=e.config.win.document.domain}catch(e){}e.config.win.beaconError("[app-context] Retrying API ",e.config.win.location.href,t)}return(d=g[g.length-1]).timeout&&(d.timeout=s),f._apiCalls[u]=f.flickrAPI.callMethod.apply(f.flickrAPI,g).then(function(t){return f.onAPICallComplete(u,!0),n.log("Successfully retried API call",{method:i}),e.fire("appContext:apiRetry",{apiMethod:i,code:418}),!YUI.Env.isServer&&e.config.win.beaconError&&e.config.win.beaconError("[app-context] Successful API retry ",e.config.win.location.href,{}),t},function(t){throw f.onAPICallComplete(u,!1),n.log("Failed retry of API call",{method:i}),e.fire("appContext:apiRetry",{apiMethod:i,code:408}),!YUI.Env.isServer&&e.config.win.beaconError&&e.config.win.beaconError("[app-context] Failed API retry ",e.config.win.location.href,{}),t}),f._concurrentAPICalls++,f._apiCalls[u]}throw t}).then(t,r)},YUI.Env.isServer?l():(f._apiQueueOrder.push(u),f._apiQueueFunctions[u]=l,f.callNextInQueue())}),this._apiCalls[u])},callNextInQueue:function(){var i,t,n=e.config.flickr.api.max_concurrent_api_calls;this._apiQueueOrder.length&&this._concurrentAPICalls<n&&(this._concurrentAPICalls++,i=this._apiQueueOrder.pop(),t=this._apiQueueFunctions[i],delete this._apiQueueFunctions[i],t())},cacheWriteAPICall:function(e,i){this.writeAPICallsMadeOnThisPage[e]={methodName:i,completed:!1,failed:!1}},onAPICallComplete:function(e,i){var t=this.writeAPICallsMadeOnThisPage[e];t&&(t.completed=!0,t.failed=!i),delete this._apiCalls[e],this._concurrentAPICalls--,this.callNextInQueue()},clearWriteAPICallCache:function(){this.writeAPICallsMadeOnThisPage={}},canEvictModel:function(e,i){var t,n;return!(!e||!i)&&(!!e.exists(i)&&(t=e.name,n=this._globalEvictionExemptionConfig[t],!(n&&n.exemptIds&&-1!==n.exemptIds.indexOf(i))&&(this._refetchedModels[t]||(this._refetchedModels[t]={}),!this._refetchedModels[t][i])))},evictModel:function(e,i){var t=e.name;this.flipper.isFlipped("model-eviction-debugging")&&console.log("[EVICT] "+t+" ["+i+"]"),e.getOwnedModels(i).forEach(function(e){this.canEvictModel(e.registry,e.id)&&this.evictModel(e.registry,e.id)}.bind(this)),e.remove(i)},evictModels:function(i){var t,o,r,s,a=this.getViewer().nsid,l=[],c=this.modelRegistries;for(t in this.writeAPICallsMadeOnThisPage)(o=this.writeAPICallsMadeOnThisPage[t]).completed&&!o.failed&&l.push(o);l.forEach(function(e){}),this._refetchExistingModels&&(a&&(i=e.merge(i,this._globalEvictionExemptionConfig)),Object.keys(this.modelRegistries).forEach(function(e){r=c[e],(s=i[e])?s.exemptIds?(s.evictIds&&n.warn("Error in eviction config for registry: cannot specify both a whitelist (`evictIds`) and a blacklist (`exemptIds`) for model eviction. Ignoring `evictIds` and evicting all models except those listed in `exemptIds`.",{modelRegistryName:e}),r.removeAllExcept(s.exemptIds)):s.evictIds&&s.evictIds.forEach(function(i){c[e].remove(i)}):c[e].removeAll()}))},markUploadInProgress:function(e){this._uploadInProgress=e},uploadIsInProgress:function(){return this._uploadInProgress},storePendingUploadErrorModal:function(e){this._pendingUploadErrorModal=e},retrievePendingUploadErrorModal:function(e){return this._pendingUploadErrorModal},_doForcedServerRender:function(){if(!YUI.Env.isServer||!this.request||!this.request.headers)return!1;var e=!1;return e=e||this.request.UA.isBot,e=e||this.request.UA.isSharingBot,this.flipper.isFlipped("enable-server-render-for-unsupported-browsers")&&(e=e||this.request.UA.isUnsupportedBrowser),this.flipper.isFlipped("enable-forced-server-render")&&(e=!0),e},getUA:function(){return YUI.Env.isServer?this.request.UA:e.config.flickr.request.UA},logViewTiming:function(){var e,i=this.flapp.get("activeView"),t=0,n=this;e=function(i,o){t++,Object.keys(i.subviews).forEach(function(r){var s=i.subviews[r].get("container").hasClass("requiredToShowOnServer")||i.subviews[r]._params.requiredToShowOnClient,a=o&&s,l="-";l=s?"🔹":"-",l=a?"🔷":l,console.log("| \t\t "+new Array(t).join(" |\t\t ")+" "+l+" "+r+" (initialization: "+n.viewTiming[r].initialize+"ms) (loadState: "+n.viewTiming[r].loadState+"ms)"),e(i.subviews[r],a)}),t--},console.log(this.routeConfig.module+": "+this.routeTiming+"ms"),console.log("🔷 "+i.name+" (initialization: "+this.viewTiming[i.name].initialize+"ms) (loadState: "+this.viewTiming[i.name].loadState+"ms)"),e(i,!0)}}},"@VERSION@",{requires:["oop","flickr-api","flickr-promise","promise","model-import-export","cookie","better-use","view-counter","flipper","localizable","moment","experiments-fullscreen","experiments-opt-out","moola-manager","viewport-data","querystring-parse-simple","querystring-stringify-simple","url-helper","browser-support","api-helper","banner-helper"]});YUI.add("querystring-stringify",function(e,t){var n=e.namespace("QueryString"),r=[],i=e.Lang;n.escape=encodeURIComponent,n.stringify=function(e,t,s){var o,u,a,f,l,c,h=t&&t.sep?t.sep:"&",p=t&&t.eq?t.eq:"=",d=t&&t.arrayKey?t.arrayKey:!1;if(i.isNull(e)||i.isUndefined(e)||i.isFunction(e))return s?n.escape(s)+p:"";if(i.isBoolean(e)||Object.prototype.toString.call(e)==="[object Boolean]")e=+e;if(i.isNumber(e)||i.isString(e))return n.escape(s)+p+n.escape(e);if(i.isArray(e)){c=[],s=d?s+"[]":s,f=e.length;for(a=0;a<f;a++)c.push(n.stringify(e[a],t,s));return c.join(h)}for(a=r.length-1;a>=0;--a)if(r[a]===e)throw new Error("QueryString.stringify. Cyclical reference");r.push(e),c=[],o=s?s+"[":"",u=s?"]":"";for(a in e)e.hasOwnProperty(a)&&(l=o+a+u,c.push(n.stringify(e[a],t,l)));return r.pop(),c=c.join(h),!c&&s?s+"=":c}},"3.16.0",{requires:["yui-base"]});
YUI.add("better-cache",function(e){function c(e,c){return e.score<c.score?-1:e.score>c.score?1:0}function t(){var e,t,o;for(r.sort(c),u={},r.length>n&&(o=r.shift()).callback&&o.callback(),e=r.length,t=0;t<e;t++)u[r[t].key]=t}var n,r=[],o=0,u={};n=e.config.flickr.better_cache_size||100,e.betterCache={reset:function(){r=[],o=0,u={}},_cache:r,getSize:function(){return r.length},unset:function(e){var c=u[e];void 0!==c&&(r.splice(c,1),t())},set:function(e,c,n){var a;!1!==c?((a=!!u[e]&&r[u[e]])?(r[u[e]].value=c,r[u[e]].score=o++,"function"==typeof n&&(a.callback=n)):(a={key:e,value:c,score:o++},"function"==typeof n&&(a.callback=n),r.push(a)),t()):this.unset(e)},get:function(e){return"number"==typeof u[e]?(r[u[e]].score=++o,r[u[e]].value):null}}},"@VERSION@");YUI.add("datatype-xml-parse",function(e,t){e.mix(e.namespace("XML"),{parse:function(t){var n=null,r;return typeof t=="string"&&(r=e.config.win,r.ActiveXObject!==undefined?(n=new ActiveXObject("Microsoft.XMLDOM"),n.async=!1,n.loadXML(t)):r.DOMParser!==undefined?n=(new DOMParser).parseFromString(t,"text/xml"):r.Windows!==undefined&&(n=new Windows.Data.Xml.Dom.XmlDocument,n.loadXml(t))),n===null||n.documentElement===null||n.documentElement.nodeName==="parsererror",n}}),e.namespace("Parsers").xml=e.XML.parse,e.namespace("DataType"),e.DataType.XML=e.XML},"3.16.0");
YUI.add("io-xdr",function(e,t){function a(e,t,n){var r='<object id="io_swf" type="application/x-shockwave-flash" data="'+e+'" width="0" height="0">'+'<param name="movie" value="'+e+'">'+'<param name="FlashVars" value="yid='+t+"&uid="+n+'">'+'<param name="allowScriptAccess" value="always">'+"</object>",i=s.createElement("div");s.body.appendChild(i),i.innerHTML=r}function f(t,n,r){return n==="flash"&&(t.c.responseText=decodeURI(t.c.responseText)),r==="xml"&&(t.c.responseXML=e.DataType.XML.parse(t.c.responseText)),t}function l(e,t){return e.c.abort(e.id,t)}function c(e){return u?i[e.id]!==4:e.c.isInProgress(e.id)}var n=e.publish("io:xdrReady",{fireOnce:!0}),r={},i={},s=e.config.doc,o=e.config.win,u=o&&o.XDomainRequest;e.mix(e.IO.prototype,{_transport:{},_ieEvt:function(e,t){var n=this,r=e.id,s="timeout";e.c.onprogress=function(){i[r]=3},e.c.onload=function(){i[r]=4,n.xdrResponse("success",e,t)},e.c.onerror=function(){i[r]=4,n.xdrResponse("failure",e,t)},e.c.ontimeout=function(){i[r]=4,n.xdrResponse(s,e,t)},e.c[s]=t[s]||0},xdr:function(t,n,i){var s=this;return i.xdr.use==="flash"?(r[n.id]=i,o.setTimeout(function(){try{n.c.send(t,{id:n.id,uid:n.uid,method:i.method,data:i.data,headers:i.headers})}catch(e){s.xdrResponse("transport error",n,i),delete r[n.id]}},e.io.xdr.delay)):u?(s._ieEvt(n,i),n.c.open(i.method||"GET",t),setTimeout(function(){n.c.send(i.data)},0)):n.c.send(t,n,i),{id:n.id,abort:function(){return n.c?l(n,i):!1},isInProgress:function(){return n.c?c(n.id):!1},io:s}},xdrResponse:function(e,t,n){n=r[t.id]?r[t.id]:n;var s=this,o=u?i:r,a=n.xdr.use,l=n.xdr.dataType;switch(e){case"start":s.start(t,n);break;case"success":s.success(f(t,a,l),n),delete o[t.id];break;case"timeout":case"abort":case"transport error":t.c={status:0,statusText:e};case"failure":s.failure(f(t,a,l),n),delete o[t.id]}},_xdrReady:function(t,r){e.fire(n,t,r)},transport:function(t){t.id==="flash"&&(a(e.UA.ie?t.src+"?d="+(new Date).valueOf().toString():t.src,e.id,t.uid),e.IO.transports.flash=function(){return s.getElementById("io_swf")})}}),e.io.xdrReady=function(t,n){var r=e.io._map[n];e.io.xdr.delay=0,r._xdrReady.apply(r,[t,n])},e.io.xdrResponse=function(t,n,r){var i=e.io._map[n.uid];i.xdrResponse.apply(i,[t,n,r])},e.io.transport=function(t){var n=e.io._map["io:0"]||new e.IO;t.uid=n._uid,n.transport.apply(n,[t])},e.io.xdr={delay:100}},"3.16.0",{requires:["io-base","datatype-xml-parse"]});
YUI.add("page-title-helper",function(e){e.pageTitleHelper=function(r){var i="Flickr";return e.Lang.isString(r)&&(r=r.trim())&&(i=r+" | "+i),i}},"@VERSION@",{requires:[]});YUI.add("flickr-route",function(r,e){var t=require("hermes-core/flog")(e),a=require("hermes-core/type-validator");r.Routes=r.Routes||{},r.FlickrRoute=function(r){this.appContext=r},r.FlickrRoute.prototype={run:function(){},setRouteDataOnHistory:function(e,t){return r.HistoryHelper.setData(this.name,e,t)},getRouteDataFromHistory:function(e){return r.HistoryHelper.getData(this.name,e)},getRouteMetaValue:function(r,e){return e?this.appContext.routeConfig.meta[r]?this.appContext.routeConfig.meta[r]:e:this.appContext.routeConfig.meta[r]?this.appContext.routeConfig.meta[r]:null},displayServerErrorOrClientRedirect:function(e,t,a){return YUI.Env.isServer?this.displayRouteErrors(e,new r.RouteError(404,t)):r.Promise.resolve({redirect:a||e.url})},detectRouteErrors:function(){return r.Array(arguments).filter(function(e,t){return e instanceof r.RouteError}).sort(function(r,e){return r.type-e.type})},displayRouteErrors:function(e,t){var a=r.Lang.isArray(t)?t[0]:t;return r.Promise.resolve(this["display"+a.type+"Error"](e,a))},display500Error:function(e,a){var i,s,o;return i={view:"error-500-page-view",params:{},headers:{statusCode:500},layout:"maximized"},(r.config.flickr.error.show_debugging_info||e.isInsecureGod||this.appContext&&this.appContext.auth&&this.appContext.auth.isInsecureGod)&&(i.params.source="flickrRoute#display500Error",i.params.message=a.message,i.params.stack=a.stack,i.params.apiMethod=a.apiMethod),YUI.Env.isServer||(i.params.message=a.message,i.params.apiMethod=a.apiMethod),e.id&&(i.params.requestID=e.id),a&&"SiteAuth"===a.type&&(a.redirect?(s=YUI.Env.isServer?e.protocol+"://"+e.hostname+e.originalUrl:e.url,o=r.url("/siteauth/?redirect_url="+encodeURIComponent(s)),YUI.Env.isServer&&t.info("Redirecting to siteauth",{production:YUI.Env.production}),i={redirect:o}):YUI.Env.isServer&&(i.params.siteAuthFailure=!0)),void 0===i.redirect?t.info("render",{status:500,req:e,err:a,isBot:this.appContext.getUA().isBot}):t.info("redirect",{status:302,req:e,location:i.redirect,isBot:this.appContext.getUA().isBot}),i},display303Error:function(r,e){return{redirect:e.options.redirect,headers:{statusCode:303}}},display403Error:function(r,e){return this.displayStandardErrorPage(r,e,403)},display404Error:function(r,e){return e=e||new Error("404"),t.info("render",{status:404,url:r.url,err:e,isBot:this.appContext.getUA().isBot}),this.displayStandardErrorPage(r,e,404)},display410Error:function(r,e){return this.displayStandardErrorPage(r,e,410)},displayStandardErrorPage:function(e,t,a){var i;return t=t||{},i={view:"fluid-error-page-view",params:{statusCode:a,url:e.url,message:t.message,catchAll:t.catchAll||!1},headers:{statusCode:a}},t.data&&(i.params=r.merge(i.params,t.data)),(r.config.flickr.error.show_debugging_info||e.isInsecureGod||this.appContext&&this.appContext.auth&&this.appContext.auth.isInsecureGod)&&(i.params.source="flickrRoute#display"+a+"Error",i.params.message=t.message),e.id&&(i.params.requestID=e.id),i},getPageNumber:function(r,e){var t=parseInt(r.params[e||"page_number"],10);return(isNaN(t)||t<=1)&&(t=1),t},getNSIDOrPathAlias:function(r){var e;return a.nsid(r)?e=r:a.pathAlias(r)?e={pathAlias:r}:t.warn("Couldn't identify "+r+" as an nsid or path alias."),e}},r.RouteError=function(r,e,t){this.type=r,this.message=e||"",this.data=t||{}}},"@VERSION@",{requires:["flickr-promise","moment","url","history-helper"]});YUI.add("site-key",function(e,t){"use strict";var i=require("hermes-core/flog")(t),r=require("hermes-core/fletrics");e.SiteKey=function(t,i){this.configurator=t||null,this.flickrAPI=i||new e.FlickrAPI,this._tasks=[]},e.SiteKey.prototype.getKey=function(){return e.config.flickr.api.site_key},e.SiteKey.prototype.isExpired=function(){return Date.now()/1e3>e.config.flickr.api.site_key_expiresAt},e.SiteKey.prototype.invalidate=function(e){var t=this._lastStored||0;if(e||(e=0),!(e<t))return this.setExpired()},e.SiteKey.prototype.setExpired=function(){return e.config.flickr.api.site_key_expiresAt=0},e.SiteKey.prototype.store=function(t,i){var r;this._lastStored=Date.now(),i||(i=Math.floor(this._lastStored/1e3)),e.config.flickr.api.site_key=t,e.config.flickr.api.site_key_fetched=i,e.config.flickr.api.site_key_expiresAt=e.config.flickr.api.site_key_fetched+e.config.flickr.api.site_key_fetch_interval,this.configurator&&((r={}).site_key=t,r.site_key_fetched=i,this.configurator.update({api:r})),this.drainQueue()},e.SiteKey.prototype.setTrustedKey=function(e){this._trustedKey=e},e.SiteKey.prototype.getTrustedKey=function(){return this._trustedKey||null},e.SiteKey.prototype.pushToQueue=function(e){this._tasks.push(e)},e.SiteKey.prototype.drainQueue=function(){for(;this._tasks.length;)this._tasks.shift().resolve()},e.SiteKey.prototype.hasQueuedTasks=function(){return!!this._tasks.length},e.SiteKey.prototype.scheduleFutureFetch=function(){this._timerFutureFetch=setTimeout(this.fetch.bind(this),1e3*e.config.flickr.api.site_key_fetch_interval)},e.SiteKey.prototype.scheduleRetry=function(t){var i=this,r=this._fetchRuns>4?1:Math.pow(2,(this._fetchRuns||1)-1)/10,s=e.config.flickr.api.site_key_retry_interval*r;clearTimeout(this._timerRetry),this._timerRetry=setTimeout(function(){i._timerRetry=null,i.fetch(t)},1e3*s)},e.SiteKey.prototype.fetch=function(t){clearTimeout(this._timerFutureFetch);var s,o=this,n=o.hasQueuedTasks();return!t&&(t=new e.Promise(function(e,t){this.resolve=e,this.reject=t}),this.pushToQueue(t),n)?t:((s=r.createStopwatch("test.site.key.api.latency")).start(),this._fetchRuns||(this._fetchRuns=0),this._fetchRuns++,this.flickrAPI.fetchSiteKey().then(function(e){var t=e.site_key;s.stop(),i.info("Received new site key",{key:t}),o._fetchRuns=0,o.store(t),r.sync(),o.scheduleFutureFetch()},function(e){r.increment("sitekey.fetch.failures"),i.error("Failed to fetch site key",{err:e}),o.scheduleRetry(t)}),t)},e.augment(e.SiteKey,e.EventTarget)},"@VERSION@",{requires:["event-custom","flickr-api","flickr-promise"]});YUI.add("hermes-lang-client-app",function(e,t){e.Intl.add("hermes/client-app","en-US",{SAVING_LAST_ACTIONS:["Hey! We’re still saving your last actions, you might lose them if you leave this page."],UPLOAD_IN_PROGRESS:["Wait! Your photos are still on the way to our servers. They might not get there if you leave this page before they arrive."]})},"@VERSION@",{requires:["intl"]});